---
title: "Box<T>"
# categories:
#   - Blog
tags: [rust]

# toc: true
# toc_sticky: true
# toc_label: "페이지 목차"
---

* 스택에 저장하는 데이타는 알려진 고정된 크기를 가져야 한다
* 컴파일 타임에 크기를 알 수 없거나 크기가 변경되는 데이타는 스택에 저장될 수 없고 힙에 저장되어야 한다
* 데이타는 heap에 저장되고, pointer는 stack에 저장된다
* mut 사용 가능

## 기본
```rust
fn main() {
    let mut b = Box::new(5);
    println!("b = {b}");

    *b = 10;
    println!("b = {b}");
}
```

## 컴파일 에러
```rust
enum List {
    // Cons variant의 크기: i32 크기 + infinite
    Cons(i32, List),
    Nil,
}

use crate::List::{Cons, Nil};

fn main() {
    // 컴파일러가 list 변수 크기를 알 수 없다
    // 컴파일러는 enum List 정의를 보고 크기를 산정하는데, recursive라서 infinite
    let list = Cons(1, Cons(2, Cons(3, Nil)));
}
```

## Box<List> 이용
```rust
enum List {
    // Cons variant의 크기: i32 크기 + Box<List> 포인터 크기
    Cons(i32, Box<List>),
    Nil,
}

use crate::List::{Cons, Nil};

fn main() {
    let list = Cons(1, Box::new(Cons(2, Box::new(Cons(3, Box::new(Nil))))));
}
```
